<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Strapi User Registration</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    </head>
    <body>
        <form class="w-50 offset-3 myform">
            <h1 class="text-center mt-5">Strapi Registration</h1>
            <div class="mb-3">
              <label for="username" class="form-label">Username</label>
              <input type="text" name="username" class="form-control" id="username" aria-describedby="emailHelp">
              <div id="emailHelp" class="form-text"></div>
            </div>
            <div class="mb-3">
              <label for="email" class="form-label">Email address</label>
              <input type="email" name="email" class="form-control" id="email" aria-describedby="emailHelp">
              <div id="emailHelp" class="form-text"></div>
            </div>
            <div class="mb-3">
              <label for="exampleInputPassword1" class="form-label">Password</label>
              <input type="password" name="password" class="form-control" id="exampleInputPassword1">
            </div>
            <div class="mb-3 form-check">
              <input type="checkbox" name="confirmed" value="true" class="form-check-input" id="exampleCheck1">
              <label class="form-check-label" for="exampleCheck1">Confirmed</label>
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
          
          <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
        <script>


            //Direct
            $('form.myform').submit(function(e){ //e = event
                e.preventDefault();

                var d = {
                    "username": $('input[name="username"]').val(),
                    "email": $('input[name="email"]').val(),
                    "provider": "string",
                    "password": $('input[name="password"]').val(),
                    "resetPasswordToken": "string",
                    "confirmationToken": "string",
                    "confirmed": true,
                    "blocked": false,
                    "role": "string",
                    "created_by": "string",
                    "updated_by": "string"
                }//$(this).serialize();

                console.log(d);
                $.ajax({
                    url:"http://localhost:1337/auth/local/register",//Kaha
                    type:"POST",//Kese
                    data:JSON.stringify(d),//Kya
                    contentType:"application/json",//Kya
                    beforeSend:function(xhr){
                        xhr.setRequestHeader ("Authorization", "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWF0IjoxNjM4NzYyMzkzLCJleHAiOjE2NDEzNTQzOTN9.QgqRNF1J13MGDzu95LzkSLC0BhrRRqlKyRUxA3gmqw4");
                    },
                    success:function(result,status,xhr){
                        try {
                            if(result.jwt){
                                //Store the data in local storage
                                localStorage.setItem("userdata",  JSON.stringify(result) );
                                swal("Good job!", "You clicked the button!", "success");
                            }
                        }
                        catch(err) {
                            swal("error!", "error", "error");
                        }
                       
                        
                        
                    }//Kaha
                })

            });
        </script>
    </body>
</html>